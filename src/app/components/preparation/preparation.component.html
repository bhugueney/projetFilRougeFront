<ng-container *ngIf="preparation">
  <mat-card class="preparationCard">
  <div class="preparationTitle">{{preparation.name}}</div>
  <div class="preparationInfos">

  <!-- 
                <mat-icon Class="preparationInfosExpandButton" [ngClass]="{'hide' : showExpand}" (click)="showExpand= !showExpand;">expand_more</mat-icon>
                <mat-icon Class="preparationInfosExpandButton" [ngClass]="{'hide' : !showExpand}" (click)="showExpand= !showExpand;">expand_less</mat-icon>


  -->
    <table>
        <tr>
          <th>
            <mat-icon  *ngIf="!showExpand" Class="preparationInfosExpandButton"  (click)="showExpand= !showExpand;">expand_more</mat-icon>
            <mat-icon  *ngIf="showExpand" Class="preparationInfosExpandButton"  (click)="showExpand= !showExpand;">expand_less</mat-icon>
          </th>
          <th>Info.&#8239;Nutritionelle</th>
          <th>Total</th>
          <th>Portion 100gr</th>
        </tr>
        <tr>
          <td colspan=2>Valeur Calorique</td>
          <td >{{preparation.totalEnergy | number: '1.2-2'}} Kcal</td>
          <td >{{preparation.energy | number: '1.2-2'}} Kcal</td>
        </tr>
        <tr *ngIf="showExpand">
          <td  colspan=2>Lipides</td>
          <td>{{preparation.totalLipid | number: '1.2-2'}} g</td>
          <td>{{preparation.lipid | number: '1.2-2'}} g</td>
        </tr>
        <tr>
          <td  colspan=2>Glucides</td>
          <td>{{preparation.totalGlucid | number: '1.2-2'}} g</td>
          <td>{{preparation.glucid | number: '1.2-2'}} g</td>
        </tr>
        <tr *ngIf="showExpand">
          <td colspan=2>Protéines</td>
          <td>{{preparation.totalProtein | number: '1.2-2'}} g</td>
          <td>{{preparation.protein | number: '1.2-2'}} g</td>
        </tr>
        <tr>
          <td colspan=2>Sucres</td>
          <td>{{preparation.totalSugar | number: '1.2-2'}} g</td>
          <td>{{preparation.sugar | number: '1.2-2'}} g</td>
        </tr>
        <tr *ngIf="showExpand">
          <td colspan=2>Fibres</td>
          <td>{{preparation.totalFiber | number: '1.2-2'}} g</td>
          <td>{{preparation.fiber | number: '1.2-2'}} g</td>
        </tr>
        <tr *ngIf="showExpand">
          <td colspan=2>Sel</td>
          <td>{{preparation.totalSalt | number: '1.2-2'}} g</td>
          <td>{{preparation.salt | number: '1.2-2'}} g</td>
        </tr>
        <tr>
          <th colspan=2>Charge glycémique</th>
          <td [ngClass]="{'Vert': (preparation.totalGlycemicLoad < 11),
                          'Orange': (preparation.totalGlycemicLoad >= 11 && preparation.totalGlycemicLoad < 20),
                          'Rouge': (preparation.totalGlycemicLoad >= 20)
                        }">
                        {{preparation.totalGlycemicLoad | number: '1.2-2'}}
          </td>
          <td  [ngClass]="{'Vert': (preparation.glycemicLoad < 11),
                          'Orange': (preparation.glycemicLoad >= 11 && preparation.totalGlycemicIndex < 20),
                          'Rouge': (preparation.glycemicLoad >= 20)
                          }">
                          {{preparation.glycemicLoad | number: '1.2-2'}}
            </td>
        </tr>
      </table>
  </div>

  <!--  [ngClass]="{'hide' : !showExpand}" -->

  <div Class="PreparationIngredientsTableContainer">

  <table mat-table [dataSource]="preparation.listIngredient" class="PreparationIngredientsTable">

      <!--- Note that these columns can be defined in any order.
            The actual rendered columns are set as a property on the row definition" -->

      <!-- Image Column -->
      <ng-container matColumnDef="image">
        <td mat-cell *matCellDef="let recipeIngredient">
          <img routerLink="/ingredient/{{recipeIngredient.ingredient.id}}" mat-card-avatar
          src="/assets/img/{{recipeIngredient.ingredient.urlImage}}"
          class="image" >
          </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
          <td mat-cell *matCellDef="let recipeIngredient" class="nameColumn">
            <h5 (click)="showDetails(recipeIngredient.ingredient)">{{recipeIngredient.ingredient.name}}</h5> 
            
          </td>
      </ng-container>

      <!-- Qty Column -->
      <ng-container matColumnDef="qty">
          <td mat-cell *matCellDef="let recipeIngredient" class="QtyCol">
              <div>
                <input class="ingredientQty" matInput type="number" value="{{recipeIngredient.quantity}}" (input)="updateQty(recipeIngredient, Qty.value)" #Qty>
                <span>grs.</span><br>
              </div>
              <mat-icon (click)="increaseQty(recipeIngredient)">add</mat-icon>
              <mat-icon (click)="decreaseQty(recipeIngredient)">remove</mat-icon>
              <mat-icon (click)="deleteRecipeIngredient(recipeIngredient)">delete_outline</mat-icon>
          </td>
      </ng-container>

      <tr mat-row *matRowDef="let row; columns: ['image', 'name', 'qty'];" class="Row"></tr>
    </table>
  </div>

  <div Class="PreparationsActionsBar">
    <button routerLink="/food" class="PreparationsActionButton">Ajout d'ingrédient(s)</button>
    <button *ngIf="userIsConnected" class="PreparationsActionButton">Enregistrer comme recette</button>
    <button *ngIf="userIsConnected" class="PreparationsActionButton">Enregistrer comme Menu</button>
    <button class="PreparationsActionButton" (click)="abandon();">Abandon</button>
  </div>
  </mat-card>
</ng-container>
